{"triggers":[],"nodes":[{"uid":"b7f1012a-8f89-45e3-9bfc-3f7ba5754516","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"2 START Dowload Files From Email\nCurrentMonthNumber =$CurrentMonthNumber.Number:toString$\nCurrentYear =$CurrentYear.Number:toString$\nDaysInCurrentMonth =$DaysInCurrentMonth.Number:toString$\nDownloadsPath =$DownloadsPath$\nEmail_ID =$vEmail_ID$\nSupportEmails =$vSupportEmails$\n\n"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"3"}}]},{"uid":"5938fb84-934b-42a2-a5c9-7dc3f366e0d5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"48b6f489-8f83-41ee-9485-4d4ae28a5a38","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------- TEMP ------------"}}]},{"uid":"14ba29b6-1313-4b9c-814a-53c99075cefb","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\rpa-botusr01-qa\\Downloads"}}],"returnTo":{"type":"VARIABLE","variableName":"DownloadsPath"}},{"uid":"d4880945-0f2f-45c6-ac26-1a8d8fba7de7","commandName":"assign","packageName":"Datetime","disabled":true,"attributes":[{"name":"option","value":{"type":"STRING","string":"constant"}},{"name":"source","value":{"type":"STRING","string":"06/01/2021 00:00:00"}},{"name":"formatType","value":{"type":"STRING","string":"custom"}},{"name":"customFormat","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"startdate"}},{"uid":"8e1d6ddb-19e9-4c38-9326-d537766f3c63","commandName":"assign","packageName":"Datetime","disabled":true,"attributes":[{"name":"option","value":{"type":"STRING","string":"constant"}},{"name":"source","value":{"type":"STRING","string":"07/01/2021 00:00:00"}},{"name":"formatType","value":{"type":"STRING","string":"custom"}},{"name":"customFormat","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"enddate"}},{"uid":"68511f18-37e3-4acb-bd25-50f0595836ed","commandName":"assignToNumber","packageName":"Number","disabled":true,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"6"}}],"returnTo":{"type":"VARIABLE","variableName":"CurrentMonthNumber"}},{"uid":"3c47cc5e-a123-4ac3-adc8-4158ffa170cd","commandName":"assignToNumber","packageName":"Number","disabled":true,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"2021"}}],"returnTo":{"type":"VARIABLE","variableName":"CurrentYear"}},{"uid":"e8c1a971-bdd6-4665-aed5-9da15e3159e0","commandName":"assignToNumber","packageName":"Number","disabled":true,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"30"}}],"returnTo":{"type":"VARIABLE","variableName":"DaysInCurrentMonth"}},{"uid":"825c383d-cfe0-4e69-82f9-a38d60e8b618","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"---------- END TEMP ------------"}}]},{"uid":"f84d16ad-932a-40e5-b814-f4d819f26e48","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8cd97ee1-d2dc-44b1-b7df-21445cafb5ac","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"constant"}},{"name":"source","value":{"type":"STRING","expression":"0$CurrentMonthNumber.Number:toString$/01/$CurrentYear.Number:toString$ 00:00:00"}},{"name":"formatType","value":{"type":"STRING","string":"custom"}},{"name":"customFormat","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"startdate"}}],"branches":[{"uid":"26d237b6-98af-4414-a60b-aafa889b965d","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"48d1c5ae-de84-4aee-aad1-c86b17872c3d","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"constant"}},{"name":"source","value":{"type":"STRING","expression":"$CurrentMonthNumber.Number:toString$/01/$CurrentYear.Number:toString$ 00:00:00"}},{"name":"formatType","value":{"type":"STRING","string":"custom"}},{"name":"customFormat","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"startdate"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$CurrentMonthNumber$"}},{"name":"operator","value":{"type":"STRING","string":"LT"}},{"name":"value","value":{"type":"NUMBER","number":"10"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"90ef9ebf-c877-4a7e-9492-6b549b844d1a","commandName":"add","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"startdate"}},{"name":"val","value":{"type":"NUMBER","expression":"$DaysInCurrentMonth$"}},{"name":"unit","value":{"type":"STRING","string":"DAYS"}}],"returnTo":{"type":"VARIABLE","variableName":"enddate"}},{"uid":"bfc71013-e6c0-466b-89b9-cc11ed0ccc03","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"startdate"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"13249129-03cf-4a1b-8e23-15916de45fc3","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"START DATE $prompt-assignment$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"3"}}]},{"uid":"043a92ab-7743-437b-9213-6cc87b520bc3","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"enddate"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"684f8503-0196-468c-9760-b2fc3219cbc1","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"END DATE $prompt-assignment$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"3"}}]},{"uid":"cbf21c76-0a90-4f85-9309-660d14b4d5ac","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"serverHost","value":{"type":"STRING","string":"outlook.office365.com"}},{"name":"port","value":{"type":"NUMBER","number":"993"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"EmailCredentials","lockerName":"EmailLocker","attributeName":"EmailID"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"EmailCredentials","lockerName":"EmailLocker","attributeName":"EmailPW"}}},{"name":"useSecure","value":{"type":"BOOLEAN","boolean":true}},{"name":"protocol","value":{"type":"STRING","string":"IMAP"}}]},{"uid":"c243a27c-93b9-4c28-981a-5ea6354da588","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5b12cceb-5ace-4798-b058-28b97d3145a4","commandName":"get","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dictemail"}},{"name":"key","value":{"type":"STRING","string":"emailMessage"}}],"returnTo":{"type":"VARIABLE","variableName":"emailmessage"}},{"uid":"cde813b0-013a-40ec-b7cd-99e716e3c584","commandName":"find","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$emailmessage$"}},{"name":"find","value":{"type":"STRING","string":"DailyGlobalFXRates"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"DocumentDateIndex"}},{"uid":"2ccbbf1c-43ed-47b6-9c88-cb001a0f01f8","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$emailmessage$"}},{"name":"startIndex","value":{"type":"NUMBER","expression":"$DocumentDateIndex$+19"}},{"name":"subStringLength","value":{"type":"NUMBER","number":"8"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"96d72bcd-f32d-4afe-959b-98eca327780c","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"constant"}},{"name":"source","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"formatType","value":{"type":"STRING","string":"preBuilt"}},{"name":"preBuiltFormat","value":{"type":"STRING","string":"BASIC_ISO_DATE"}}],"returnTo":{"type":"VARIABLE","variableName":"filedate"}},{"uid":"873c371a-c6da-4a27-9ec9-1960d4fcd7e6","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"filedate"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"b8934ff8-6808-4e10-b8ba-bcc3b96a7e04","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"1cd3a511-7fbd-4f66-aebc-2c66f2f15760","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6db9bcd9-5280-48a2-bbbe-90abf52949a1","commandName":"saveAttachment","packageName":"Email","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$DownloadsPath$"}},{"name":"checkOverrwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceDateOption","value":{"type":"STRING","string":"DATETIME"}},{"name":"sourceDateTime","value":{"type":"VARIABLE","variableName":"filedate"}},{"name":"operator","value":{"type":"STRING","string":"GTE"}},{"name":"destDateOption","value":{"type":"STRING","string":"DATETIME"}},{"name":"destDateTime","value":{"type":"VARIABLE","variableName":"startdate"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"dateVariable","packageName":"Datetime"},"attributes":[{"name":"sourceDateOption","value":{"type":"STRING","string":"DATETIME"}},{"name":"sourceDateTime","value":{"type":"VARIABLE","variableName":"filedate"}},{"name":"operator","value":{"type":"STRING","string":"LTE"}},{"name":"destDateOption","value":{"type":"STRING","string":"DATETIME"}},{"name":"destDateTime","value":{"type":"VARIABLE","variableName":"enddate"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"dateVariable","packageName":"Datetime"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dictemail"},"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession"}},{"name":"readStatus","value":{"type":"STRING","string":"ALL"}},{"name":"folder","value":{"type":"STRING","string":"Inbox"}},{"name":"subject","value":{"type":"STRING","string":"Info: Bloomberg Exchage Rate File received"}},{"name":"from","value":{"type":"STRING","string":"netuic@supind.com"}},{"name":"since","value":{"type":"VARIABLE","variableName":"startdate"}},{"name":"before","value":{"type":"VARIABLE","variableName":"enddate"}},{"name":"messageFormat","value":{"type":"STRING","string":"PLAINTEXT"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.email","packageName":"Email"}}]},{"uid":"cf75d14c-ef9d-46c7-9252-c6ca3a794aec","commandName":"closeEmail","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"string":"EmailSession","type":"STRING"}}]}],"branches":[{"uid":"de185d04-64a3-46cc-a9f9-db69ccc0bd20","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"69fca5d4-b695-416f-9ca0-096cce28d16f","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"ErrorOcurred"}},{"uid":"852e5696-e0c7-4755-a8ab-df8626668230","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/FX%20Rate%20Audit%20File/Log/Error_Snapshot.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"8c83bf5a-977a-4884-8319-8e30e18091ed","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/FX%20Rate%20Audit%20File/Log/Logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"----- $System:AATaskName$ -----\nError Line Number --> $Error-LineNumber.Number:toString$Â¨\nError Description --> $Error-Description$\n---"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"bdde8b35-b8a3-43f7-a794-0155983e9bfb","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vSupportEmails$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/FX%20Rate%20Audit%20File/Log/Error_Snapshot.png"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \n\nError line number: $Error-LineNumber.Number:toString$ \n\nError message: $Error-Description$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmail_ID$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@IMAPHostname$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@IMAPPortNumber$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":true}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":true}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"EmailCredentials","lockerName":"EmailLocker","attributeName":"EmailID"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"EmailCredentials","lockerName":"EmailLocker","attributeName":"EmailPW"}}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"startdate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"dictemail","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"emailmessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"DocumentDateIndex","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"emaildate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"emailmonth","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"enddate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DATETIME","string":""}},{"name":"filedate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DATETIME","string":""}},{"name":"DownloadsPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"CurrentMonthNumber","description":"","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"CurrentYear","description":"","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"DaysInCurrentMonth","description":"","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"ErrorOcurred","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"vSupportEmails","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"vEmail_ID","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210118-184958"},{"name":"Comment","version":"2.4.0-20210118-185007"},{"name":"Datetime","version":"2.2.0-20210118-185018"},{"name":"Dictionary","version":"3.2.0-20210118-185020"},{"name":"Email","version":"3.3.0-20210109-150633"},{"name":"ErrorHandler","version":"2.4.0-20210118-185029"},{"name":"If","version":"2.1.0-20210118-185039"},{"name":"LogToFile","version":"2.2.0-20210118-185320"},{"name":"Loop","version":"2.1.0-20210118-185321"},{"name":"MessageBox","version":"2.1.0-20210118-185321"},{"name":"Number","version":"2.3.0-20210118-185335"},{"name":"Screen","version":"2.2.0-20210118-185815"},{"name":"String","version":"3.2.0-20210118-185827"},{"name":"System","version":"3.1.0-20210122-195716"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}