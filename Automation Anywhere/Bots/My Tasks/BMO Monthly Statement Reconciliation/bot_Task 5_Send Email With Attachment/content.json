{"nodes":[{"uid":"180bc5dc-5052-494f-997a-c45515406c01","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"ae337b5a-39c3-4662-90fb-ee4487847746","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"rpa-botusr01-qa@supind.com"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmail_ID"}},{"uid":"275047bf-03d6-4ec2-a2e0-535122bdd524","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vEmail_ID.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vEmail_ID"}},{"uid":"a45b6e81-77aa-4790-aea8-00863241e009","commandName":"try","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"2f448655-1f81-46dc-ad1d-36966a69d09f","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Send zip to email"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"3"}}]},{"uid":"0bffaeea-db54-4fbb-aae0-10541d7f1e30","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\BMO Monthly Statement Reconciliation\\Output\\$vStatementsFolder$\\Statement_Manager_$vStatementsMonth$ $vStatementsYear$.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileStatements"}},{"uid":"8ba917fd-e677-4231-9573-0efe897d22cb","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileStatements.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileStatements"}},{"uid":"f233ea30-3d7d-4138-a30b-6dfa1aadce6f","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vFileStatements$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"0f332fed-b4fc-462d-aef2-628bd88bc530","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the conditional commands here."}}]},{"uid":"35f4ac2f-fc02-442a-a4d4-e0befa356e81","commandName":"zipFiles","packageName":"Folder","attributes":[{"name":"sourcePath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\BMO Monthly Statement Reconciliation\\Output\\$vStatementsFolder$"}},{"name":"targetPath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/BMO%20Monthly%20Statement%20Reconciliation/Output/$vStatementsFolder$.zip"}},{"name":"isUpdateNewer","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDeleteOriginalFiles","value":{"type":"BOOLEAN","boolean":false}},{"name":"compressionLevel","value":{"type":"STRING","string":"Normal"}},{"name":"filterType","value":{"type":"STRING","string":"StringValue"}},{"name":"filterExtensions","value":{"type":"STRING","string":""}}]},{"uid":"ef269a8f-653d-40cb-b386-765fbb1093c6","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/BMO%20Monthly%20Statement%20Reconciliation/Output/$vStatementsFolder$.zip"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"d2a05954-a2c9-44bd-bec7-f2de2bc686de","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Please enter the conditional commands here."}}]},{"uid":"7c2b4c07-5aed-4942-bbe1-040227bd4c7d","commandName":"sendMail","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmail_ID$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vDestinationEmails$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"BMO Monthly Statement Reconciliation - Executed"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/BMO%20Monthly%20Statement%20Reconciliation/Output/$vStatementsFolder$.zip%3B"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"BMO Monthly Statement Reconciliation\n\nBot has finished execution. Please find the attached file for bot run report.\n\n$vStatementsFolder$.zip\n\nRegards"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"userName"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"password"}}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_ssl$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_auth$"}}]},{"uid":"54e5e8ea-1045-42a5-839b-9ad5f69b1a4a","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Email Sent"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"efed1fd3-c602-4173-973f-ca09c3717572","commandName":"else","packageName":"If","attributes":[],"children":[{"uid":"9b452696-e4a4-4247-a983-6a5a61eb8210","commandName":"messageBox","packageName":"MessageBox","attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Zip not found"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"3"}}]},{"uid":"ef5969c5-1a52-4aec-af3f-e8b8739f9811","commandName":"sendMail","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmail_ID$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vSupportEmails$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"BMO Monthly Statement Reconciliation - Error"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"BMO Monthly Statement Reconciliation\n\nTHE ZIP FILE DOES NOT EXISTS\n\n$vStatementsFolder$.zip\n\nRegards"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"userName"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"password"}}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_ssl$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_auth$"}}]}]}]}],"branches":[{"uid":"b972302f-260e-4566-8229-3b7de5da12a5","commandName":"else","packageName":"If","attributes":[],"children":[{"uid":"d1d3df59-4403-4364-96ef-301456de4a3e","commandName":"sendMail","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmail_ID$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vSupportEmails$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"BMO Monthly Statement Reconciliation - Error"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"BMO Monthly Statement Reconciliation\n\nTHE EXCEL FILE DOES NOT EXISTS\n\n$vStatementsFolder$.xlsx\n\nRegards"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"userName"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"password"}}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_ssl$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_auth$"}}]}]}]}],"branches":[{"uid":"cc22c34d-0191-42a3-b4d3-c3577f3fabac","commandName":"catch","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}},"children":[{"uid":"d266a57c-e03b-4d1f-8937-774c93bced1d","commandName":"assign","packageName":"Boolean","attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"d271736d-ac81-4168-a8cb-c70441c442bc","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/BMO%20Monthly%20Statement%20Reconciliation/Output/Logs.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"Error Line Number$Error-LineNumber.Number:toString$¨\nError Description¨$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5d2511e8-36e5-4d86-872d-6b4ba3d307bc","commandName":"captureDesktop","packageName":"Screen","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/Failure/BMO_Error_$System:Month.Number:toString$$System:Day.Number:toString$$System:Year.Number:toString$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"ff47c881-993f-4b5a-9a45-ac86e8645301","commandName":"logToFile","packageName":"LogToFile","attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/Failure/Error%20Message.txt"}},{"name":"logContent","value":{"type":"STRING","expression":"$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"OVERWRITE_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"26f796a9-b663-4447-b1ac-24119e706903","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorOcurred"}},{"uid":"072d67df-54a9-491a-ac69-28f3e009b7b6","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vErrorOcurred.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorOcurred"}},{"uid":"12479201-8de6-409f-98a2-762bd043d21e","commandName":"toString","packageName":"Datetime","attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"de9d25d7-ca9a-4fb0-9e87-13b509cf689f","commandName":"sendMail","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$vEmail_ID$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$vSupportEmails$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/Failure/BMO_Error_$System:Month.Number:toString$$System:Day.Number:toString$$System:Year.Number:toString$.png%3B$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/Failure/Error%20Message.txt"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"userName"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"password"}}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_ssl$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_auth$"}}]},{"uid":"4bf9a54c-af01-41a4-99db-3c26927a7703","commandName":"stopTask","packageName":"TaskBot","attributes":[]}]}]}],"branches":[{"uid":"353c3edb-8c17-4e11-8d10-c1c7c44be95c","commandName":"finally","packageName":"ErrorHandler","attributes":[],"children":[{"uid":"9d2f5e7a-3dd3-485c-8253-9b4b885f970f","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}]}],"children":[{"uid":"d44b450d-38c0-4875-aa60-f571ceb849c8","commandName":"throw","packageName":"ErrorHandler","attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"vEmail_ID","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vStatementsFolder","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorOcurred","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"false"}},{"name":"vStatementsYear","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vStatementsMonth","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vSupportEmails","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vDestinationEmails","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileStatements","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"ErrorHandler","version":"2.4.0-20210118-185029"},{"name":"String","version":"3.2.0-20210118-185827"},{"name":"LegacyAutomation","version":"3.3.0-20210121-015801"},{"name":"System","version":"3.1.0-20210122-195716"},{"name":"Number","version":"2.3.0-20210118-185335"},{"name":"MessageBox","version":"2.1.0-20210118-185321"},{"name":"If","version":"2.1.0-20210118-185039"},{"name":"File","version":"3.2.0-20210118-185031"},{"name":"Comment","version":"2.4.0-20210118-185007"},{"name":"Folder","version":"3.1.0-20210118-185034"},{"name":"Email","version":"3.3.0-20210109-150633"},{"name":"Boolean","version":"2.1.0-20210118-184958"},{"name":"LogToFile","version":"2.2.0-20210118-185320"},{"name":"Screen","version":"2.2.0-20210118-185815"},{"name":"Datetime","version":"2.2.0-20210118-185018"},{"name":"TaskBot","version":"2.0.1-20210128-041521"}]}